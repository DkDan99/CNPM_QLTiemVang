CREATE DATABASE QLCHKDVBĐQ

USE QLCHKDVBĐQ

--------------------TABLE, PRIMARY KEY--------------------

CREATE TABLE SANPHAM(
MaSanPham CHAR(8) NOT NULL,
MaDonViTinh CHAR(8) NOT NULL,
TenSanPham VARCHAR(32) NOT NULL,
LoaiSanPham VARCHAR(16) NOT NULL,
DonGiaBan INT NOT NULL,
DonGiaMua  INT NOT NULL,
PTLN DECIMAL(3,2) NOT NULL,
CONSTRAINT PK_01 PRIMARY KEY (MaSanPham)
)

CREATE TABLE DONVITINH(
MaDonViTinh CHAR(8) NOT NULL,
DonViTinh VARCHAR(8) NOT NULL,
CONSTRAINT PK_02 PRIMARY KEY (MaDonViTinh)
)

CREATE TABLE KHACHHANG(
MaKhachHang CHAR(8) NOT NULL,
TenKhachHang VARCHAR(32) NOT NULL,
SDT VARCHAR(10) NOT NULL,
CONSTRAINT PK_03 PRIMARY KEY (MaKhachHang)
)

CREATE TABLE DICHVU(
MaDichVu CHAR(8) NOT NULL,
LoaiDichVu VARCHAR(32) NOT NULL,
DonGia INT NOT NULL,
CONSTRAINT PK_04 PRIMARY KEY (MaDichVu)
)

CREATE TABLE PHIEUBANHANG(
MaPhieuBanHang CHAR(8) NOT NULL,
MaKhachHang CHAR(8) NOT NULL,
NgayLap DATE NOT NULL,
CONSTRAINT PK_05 PRIMARY KEY (MaPhieuBanHang)
)

CREATE TABLE PHIEUMUAHANG(
MaPhieuMuaHang CHAR(8) NOT NULL,
MaNhaCungCap CHAR(8) NOT NULL,
NgayLap DATE NOT NULL,
CONSTRAINT PK_06 PRIMARY KEY (MaPhieuMuaHang)
)

CREATE TABLE PHIEUDICHVU(
MaPhieuDichVu CHAR(8) NOT NULL,
MaKhachHang CHAR(8) NOT NULL,
NgayLap DATE NOT NULL,
TongTraTruoc INT NOT NULL,
TongTien INT NOT NULL,
TongConLai INT NOT NULL,
ChiPhiRieng INT NOT NULL,
TinhTrangChung VARCHAR(20) NOT NULL,
CONSTRAINT PK_07 PRIMARY KEY (MaPhieuDichVu)
)

CREATE TABLE BAOCAOTONKHO(
MaBCTK CHAR(8) NOT NULL,
MaSanPham CHAR(8) NOT NULL,
TonDau INT NOT NULL,
SoLuongMuaVao INT NOT NULL,
SoLuongBanRa INT NOT NULL,
TonCuoi INT NOT NULL,
Thang DATE NOT NULL,
CONSTRAINT PK_08 PRIMARY KEY (MaBCTK)
)

CREATE TABLE NHACUNGCAP(
MaNhaCungCap CHAR(8) NOT NULL,
TenNhaCungCap VARCHAR(30) NOT NULL,
DiaChi VARCHAR(128) NOT NULL,
SDT VARCHAR(10) NOT NULL,
CONSTRAINT PK_09 PRIMARY KEY (MaNhaCungCap)
)

CREATE TABLE DV_PDV(
MaDichVu CHAR(8) NOT NULL,
MaPhieuDichVu CHAR(8) NOT NULL,
SoLuong INT NOT NULL,
DonGiaTinh INT NOT NULL,
ThanhTien INT NOT NULL,
TraTruoc INT NOT NULL,
ConLai INT NOT NULL,
NgayGiao DATE NOT NULL,
TinhTrang VARCHAR(20) NOT NULL,
CONSTRAINT PK_10 PRIMARY KEY (MaDichVu,MaPhieuDichVu)
)

CREATE TABLE SANPHAM_MUA(
MaSanPham CHAR(8) NOT NULL,
MaPhieuMuaHang CHAR(8) NOT NULL,
ThanhTien INT NOT NULL,
DonGia INT NOT NULL,
SoLuong INT NOT NULL,
CONSTRAINT PK_11 PRIMARY KEY (MaSanPham,MaPhieuMuaHang)
)

CREATE TABLE SANPHAM_BAN(
MaSanPham CHAR(8) NOT NULL,
MaPhieuBanHang CHAR(8) NOT NULL,
ThanhTien INT NOT NULL,
DonGia INT NOT NULL,
SoLuong INT NOT NULL,
CONSTRAINT PK_12 PRIMARY KEY (MaSanPham,MaPhieuBanHang)
)

CREATE TABLE SANPHAM_TONKHO(
MaSanPham CHAR(8) NOT NULL,
MaBCTK CHAR(8) NOT NULL,
CONSTRAINT PK_13 PRIMARY KEY (MaSanPham,MaBCTK),
CONSTRAINT DUYNHAT UNIQUE (MaSanPham,MaBCTK)
)

CREATE TABLE THAMSO(
TyLeTraTruoc DECIMAL(3,2) NOT NULL
)

SET DATEFORMAT DMY

--------------------INSERT DATA--------------------

----------SANPHAM

INSERT INTO SANPHAM (MaSanPham, MaDonViTinh, TenSanPham, LoaiSanPham, DonGiaBan, DonGiaMua, PTLN) VALUES
('SP000001', 'DVT0004', N'Nhẫn Vàng 24K', 'LSP4', 24816000, 4800000, 4.17),
('SP000002', 'DVT0001', N'Lắc tay nam', 'LSP1', 8554000, 1400000, 5.11),
('SP000003', 'DVT0001', N'Lắc Chân Bạc', 'LSP1', 28252000, 2800000, 9.09),
('SP000004', 'DVT0003', N'Vàng 24K nguyên liệu', 'LSP3', 33375000, 7500000, 3.45),
('SP000005', 'DVT0003', N'Bạc nguyên liệu', 'LSP3', 9585500, 950000, 9.09),
('SP000006', 'DVT0002', N'Kim cương nguyên liệu', 'LSP2', 23585000, 5300000, 3.45),
('SP000007', 'DVT0003', N'Vàng miếng 24K', 'LSP3', 3025000, 1100000, 1.75),
('SP000008', 'DVT0002', N'Kim cương thô', 'LSP2', 36805000, 8500000, 3.33),
('SP000009', 'DVT0004', N'Nhẫn cưới', 'LSP4', 36308000, 5800000, 5.26),
('SP000010', 'DVT0001', N'Lắc tay nữ', 'LSP1', 10175000, 1250000, 7.14);

----------DONVITINH

INSERT INTO DONVITINH (MaDonViTinh, DonViTinh) VALUES
('DVT0001', N'Bộ'),
('DVT0002', N'Gram'),
('DVT0003', N'Kg'),
('DVT0004', N'Chiếc');

----------KHACHHANG

INSERT INTO KHACHHANG (MaKhachHang, TenKhachHang, SDT) VALUES
('KH000001', 'Nguyen Van A', '0912345678'),
('KH000002', 'Le Thi B', '0987654321'),
('KH000003', 'Tran Van C', '0901122334'),
('KH000004', 'Pham Thi D', '0912233445'),
('KH000005', 'Hoang Van E', '0922334455'),
('KH000006', 'Vu Thi F', '0933445566'),
('KH000007', 'Nguyen Van G', '0944556677'),
('KH000008', 'Le Thi H', '0955667788'),
('KH000009', 'Tran Van I', '0966778899'),
('KH000010', 'Pham Thi J', '0977889900');

----------DICHVU

INSERT INTO DICHVU (MaDichVu, LoaiDichVu, DonGia) VALUES
('DV000001', N'Đánh bóng trang sức', 50000),
('DV000002', N'Khắc chữ trang sức', 100000),
('DV000003', N'Sửa chữa trang sức', 150000),
('DV000004', N'Tạo mẫu trang sức', 200000),
('DV000005', N'Vệ sinh trang sức', 30000);

----------PHIEUBANHANG

INSERT INTO PHIEUBANHANG (MaPhieuBanHang, MaKhachHang, NgayLap) VALUES
('PBH0001', 'KH000001', '01-05-2024'),
('PBH0002', 'KH000002', '02-05-2024'),
('PBH0003', 'KH000003', '03-05-2024'),
('PBH0004', 'KH000004', '04-05-2024'),
('PBH0005', 'KH000005', '05-05-2024'),
('PBH0006', 'KH000006', '06-05-2024'),
('PBH0007', 'KH000007', '07-05-2024'),
('PBH0008', 'KH000008', '08-05-2024'),
('PBH0009', 'KH000009', '09-05-2024'),
('PBH0010', 'KH000010', '10-05-2024');

----------PHIEUMUAHANG

INSERT INTO PHIEUMUAHANG (MaPhieuMuaHang, MaNhaCungCap, NgayLap) VALUES
('PMH0001', 'NCC0001', '01-05-2024'),
('PMH0002', 'NCC0002', '02-05-2024'),
('PMH0003', 'NCC0003', '03-05-2024'),
('PMH0004', 'NCC0004', '04-05-2024'),
('PMH0005', 'NCC0005', '05-05-2024'),
('PMH0006', 'NCC0006', '06-05-2024'),
('PMH0007', 'NCC0007', '07-05-2024'),
('PMH0008', 'NCC0008', '08-05-2024'),
('PMH0009', 'NCC0009', '09-05-2024'),
('PMH0010', 'NCC0010', '10-05-2024');

----------PHIEUDICHVU

INSERT INTO PHIEUDICHVU (MaPhieuDichVu, MaKhachHang, NgayLap, TongTraTruoc, TongTien, TongConLai, ChiPhiRieng, TinhTrangChung) VALUES
('PDV0001', 'KH000001', '01-05-2024', 300000, 400684, 100684, 342, N'Chưa hoàn thành'),
('PDV0002', 'KH000002', '02-05-2024', 26000, 50643, 24643, 643, N'Hoàn thành'),
('PDV0003', 'KH000003', '03-05-2024', 120000, 200908, 80908, 454, N'Chưa hoàn thành'),
('PDV0004', 'KH000004', '04-05-2024', 78000, 150978, 72978, 978, N'Chưa hoàn thành'),
('PDV0005', 'KH000005', '05-05-2024', 130000, 200353, 70353, 353, N'Hoàn thành'),
('PDV0006', 'KH000001', '06-05-2024', 40000, 61070, 21070, 535, N'Hoàn thành'),
('PDV0007', 'KH000002', '07-05-2024', 26000, 50223, 24223, 223, N'Chưa hoàn thành'),
('PDV0008', 'KH000003', '08-05-2024', 190000, 200350, 10350, 175, N'Hoàn thành'),
('PDV0009', 'KH000003', '09-05-2024', 80000, 150688, 70688, 688, N'Chưa hoàn thành'),
('PDV0010', 'KH000006', '10-05-2024', 150000, 200300, 50300, 300, N'Chưa hoàn thành'),
('PDV0011', 'KH000007', '11-05-2024', 50000, 90600, 40600, 200, N'Hoàn thành'),
('PDV0012', 'KH000007', '12-05-2024', 70000, 101000, 31000, 500, N'Chưa hoàn thành'),
('PDV0013', 'KH000008', '13-05-2024', 90000, 100400, 10400, 400, N'Hoàn thành'),
('PDV0014', 'KH000009', '14-05-2024', 200000, 301200, 101200, 600, N'Chưa hoàn thành'),
('PDV0015', 'KH000010', '15-05-2024', 150000, 200500, 50500, 500, N'Hoàn thành'),
('PDV0016', 'KH000005', '16-05-2024', 40000, 60200, 20200, 100, N'Chưa hoàn thành');


----------BAOCAOTONKHO

INSERT INTO BAOCAOTONKHO (MaBCTK, MaSanPham, TonDau, SoLuongMuaVao, SoLuongBanRa, TonCuoi, Thang) VALUES
('BCTK001', 'SP000001', 10, 20, 15, 15, '01-05-2024'),
('BCTK002', 'SP000002', 5, 10, 8, 7, '01-05-2024'),
('BCTK003', 'SP000003', 8, 15, 12, 11, '01-05-2024'),
('BCTK004', 'SP000004', 3, 5, 4, 4, '01-05-2024'),
('BCTK005', 'SP000005', 6, 12, 10, 8, '01-05-2024'),
('BCTK006', 'SP000006', 3, 3, 3, 3, '01-05-2024'),
('BCTK007', 'SP000007', 3, 3, 3, 3, '01-05-2024'),
('BCTK008', 'SP000008', 3, 3, 3, 3, '01-05-2024'),
('BCTK009', 'SP000009', 3, 3, 3, 3, '01-05-2024'),
('BCTK010', 'SP000010', 3, 3, 3, 3, '01-05-2024');

----------NHACUNGCAP

INSERT INTO NHACUNGCAP (MaNhaCungCap, TenNhaCungCap, DiaChi, SDT) VALUES
('NCC0001', N'Công ty Vàng Bạc Đá Quý ABC', N'123 Đường A, Quận 1, TP.HCM', '0912345678'),
('NCC0002', N'Công ty Vàng Bạc Đá Quý DEF', N'456 Đường B, Quận 2, TP.HCM', '0987654321'),
('NCC0003', N'Công ty Vàng Bạc Đá Quý GHI', N'789 Đường C, Quận 3, TP.HCM', '0901122334'),
('NCC0004', N'Công ty Vàng Bạc Đá Quý JKL', N'321 Đường D, Quận 4, TP.HCM', '0912233445'),
('NCC0005', N'Công ty Vàng Bạc Đá Quý MNO', N'654 Đường E, Quận 5, TP.HCM', '0922334455'),
('NCC0006', N'Công ty Vàng Bạc Đá Quý PQR', N'123 Đường F, Quận 6, TP.HCM', '0933445566'),
('NCC0007', N'Công ty Vàng Bạc Đá Quý STU', N'456 Đường G, Quận 7, TP.HCM', '0944556677'),
('NCC0008', N'Công ty Vàng Bạc Đá Quý VWX', N'789 Đường H, Quận 8, TP.HCM', '0955667788'),
('NCC0009', N'Công ty Vàng Bạc Đá Quý YZA', N'321 Đường I, Quận 9, TP.HCM', '0966778899'),
('NCC0010', N'Công ty Vàng Bạc Đá Quý BCD', N'654 Đường J, Quận 10, TP.HCM', '0977889900');

----------DV_PDV

INSERT INTO DV_PDV (MaDichVu, MaPhieuDichVu, SoLuong, DonGiaTinh, ThanhTien, TraTruoc, ConLai, NgayGiao, TinhTrang) VALUES
('DV000004', 'PDV0001', 2, 200342, 400684, 300000, 100684, '03-05-2024', N'Chưa giao'),
('DV000001', 'PDV0002', 1, 50643, 50643, 26000, 24643, '02-05-2024', N'Đã giao'),
('DV000002', 'PDV0003', 2, 100454, 200908, 120000, 80908, '03-05-2024', N'Chưa giao'),
('DV000003', 'PDV0004', 1, 150978, 150978, 78000, 72978, '04-05-2024', N'Chưa giao'),
('DV000004', 'PDV0005', 1, 200353, 200353, 130000, 70353, '08-05-2024', N'Đã giao'),
('DV000005', 'PDV0006', 2, 30535, 61070, 40000, 21070, '08-05-2024', N'Đã giao'),
('DV000001', 'PDV0007', 1, 50223, 50223, 26000, 24223, '07-05-2024', N'Chưa giao'),
('DV000002', 'PDV0008', 2, 100175, 200350, 190000, 10350, '08-05-2024', N'Đã giao'),
('DV000003', 'PDV0009', 1, 150688, 150688, 80000, 70688, '09-05-2024', N'Chưa giao'),
('DV000004', 'PDV0010', 1, 200300, 200300, 150000, 50300, '10-05-2024', N'Chưa giao'),
('DV000005', 'PDV0011', 3, 30200, 90600, 50000, 40600, '11-05-2024', N'Đã giao'),
('DV000001', 'PDV0012', 2, 50500, 101000, 70000, 31000, '12-05-2024', N'Chưa giao'),
('DV000002', 'PDV0013', 1, 100400, 100400, 90000, 10400, '13-05-2024', N'Đã giao'),
('DV000003', 'PDV0014', 2, 150600, 301200, 200000, 101200, '14-05-2024', N'Chưa giao'),
('DV000004', 'PDV0015', 1, 200500, 200500, 150000, 50500, '15-05-2024', N'Đã giao'),
('DV000005', 'PDV0016', 2, 30100, 60200, 40000, 20200, '16-05-2024', N'Chưa giao');

----------SANPHAM_MUA

INSERT INTO SANPHAM_MUA (MaSanPham, MaPhieuMuaHang, ThanhTien, DonGia, SoLuong) VALUES
('SP000001', 'PMH0001', 96000000, 4800000, 20),
('SP000002', 'PMH0002', 14000000, 1400000, 10),
('SP000003', 'PMH0003', 42000000, 2800000, 15),
('SP000004', 'PMH0004', 37500000, 7500000, 5),
('SP000005', 'PMH0005', 11400000, 950000, 12),
('SP000006', 'PMH0006', 10600000, 5300000, 2),
('SP000007', 'PMH0007', 2200000, 1100000, 2),
('SP000008', 'PMH0008', 25500000, 8500000, 3),
('SP000009', 'PMH0009', 58000000, 5800000, 10),
('SP000010', 'PMH0010', 3750000, 1250000, 3);

----------SANPHAM_BAN

INSERT INTO SANPHAM_BAN (MaSanPham, MaPhieuBanHang, ThanhTien, DonGia, SoLuong) VALUES
('SP000001', 'PBH0001', 372240000, 24816000, 15),
('SP000002', 'PBH0002', 68432000, 8554000, 8),
('SP000003', 'PBH0003', 339024000, 28252000, 12),
('SP000004', 'PBH0004', 133500000, 33375000, 4),
('SP000005', 'PBH0005', 95855000, 9585500, 10),
('SP000006', 'PBH0006', 70755000, 23585000, 3),
('SP000007', 'PBH0007', 9075000, 3025000, 3),
('SP000008', 'PBH0008', 110415000, 36805000, 3),
('SP000009', 'PBH0009', 108924000, 36308000, 3),
('SP000010', 'PBH0010', 30525000, 10175000, 3);

----------SANPHAM_TONKHO

INSERT INTO SANPHAM_TONKHO (MaSanPham, MaBCTK) VALUES
('SP000001', 'BCTK001'),
('SP000002', 'BCTK002'),
('SP000003', 'BCTK003'),
('SP000004', 'BCTK004'),
('SP000005', 'BCTK005'),
('SP000006', 'BCTK006'),
('SP000007', 'BCTK007'),
('SP000008', 'BCTK008'),
('SP000009', 'BCTK009'),
('SP000010', 'BCTK010');

----------THAMSO

INSERT INTO THAMSO (TyLeTraTruoc) VALUES
(0.5);

--------------------FOREIGN KEY--------------------

ALTER TABLE SANPHAM ADD CONSTRAINT FK_01 FOREIGN KEY (MaDonViTinh) REFERENCES DONVITINH(MaDonViTinh)
ALTER TABLE PHIEUBANHANG ADD CONSTRAINT FK_02 FOREIGN KEY (MaKhachHang) REFERENCES KHACHHANG(MaKhachHang)
ALTER TABLE PHIEUMUAHANG ADD CONSTRAINT FK_03 FOREIGN KEY (MaNhaCungCap) REFERENCES NHACUNGCAP(MaNhaCungCap)
ALTER TABLE PHIEUDICHVU ADD CONSTRAINT FK_05 FOREIGN KEY (MaKhachHang) REFERENCES KHACHHANG(MaKhachHang)
ALTER TABLE BAOCAOTONKHO ADD CONSTRAINT FK_06 FOREIGN KEY (MaSanPham) REFERENCES SANPHAM(MaSanPham)
ALTER TABLE DV_PDV ADD CONSTRAINT FK_07 FOREIGN KEY (MaDichVu) REFERENCES DICHVU(MaDichVu)
ALTER TABLE DV_PDV ADD CONSTRAINT FK_08 FOREIGN KEY (MaPhieuDichvu) REFERENCES PHIEUDICHVU(MaPhieuDichvu)
ALTER TABLE SANPHAM_MUA ADD CONSTRAINT FK_09 FOREIGN KEY (MaSanPham) REFERENCES SANPHAM(MaSanPham)
ALTER TABLE SANPHAM_BAN ADD CONSTRAINT FK_10 FOREIGN KEY (MaSanPham) REFERENCES SANPHAM(MaSanPham)
ALTER TABLE SANPHAM_MUA ADD CONSTRAINT FK_11 FOREIGN KEY (MaPhieuMuaHang) REFERENCES PHIEUMUAHANG(MaPhieuMuaHang)
ALTER TABLE SANPHAM_BAN ADD CONSTRAINT FK_12 FOREIGN KEY (MaPhieuBanHang) REFERENCES PHIEUBANHANG(MaPhieuBanHang)
ALTER TABLE SANPHAM_TONKHO ADD CONSTRAINT FK_13 FOREIGN KEY (MaSanPham) REFERENCES SANPHAM(MaSanPham)
ALTER TABLE SANPHAM_TONKHO ADD CONSTRAINT FK_14 FOREIGN KEY (MaBCTK) REFERENCES BAOCAOTONKHO(MaBCTK)